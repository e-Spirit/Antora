<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: CrownSpirit Documentation</title>
    <link rel="canonical" href="https://e-spirit.github.io/Antora/ecom/1.0/SAP_Classic/EN/fs-installation/schedule/custom-process.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../../_'</script>
    <link rel="icon" href="../../../../../../_/img/shortcut-icon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://e-spirit.github.io/Antora">CrownSpirit Documentation</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Cloud</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Headless</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">E-Commerce</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spryker/index.html">Spryker</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spartacus/index.html">Spartacus</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">FirstSpirit</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=editors">Editors</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=developers">Developers</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=administrators">Administrators</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Crownpeak</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ecom" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../../index.html">E-Commerce</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../../Spryker/index.html">Spryker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/spryker-installation/spryker-installation.html">Spryker - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/fs-installation/fs-installation.html">FirstSpirit - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/use-cases/use-cases.html">Use Cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/legal-notice.html">Legal Notice</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spartacus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../../Spartacus/chapters/introduction.html">Main Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/sapcc-installation/sapcc-installation.html">Spartacus - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/fs-installation/fs-installation.html">FirstSpirit - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/use-cases/use-cases.html">Use Cases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spartacus/FS_Connect_SAP_hl_ServeradminManual_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../../Salesforce/index.html">Salesforce</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SAP Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../firstspiritconnect-sap-documentation_EN.html">Main Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../firstspiritconnect-sap-admindoc_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">E-Commerce</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../../component-b/1.0/index.html">CrownSpirit Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../component-b/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../../index.html">E-Commerce</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../fsxa-pwa/1.3.0/index.html">FSXA-PWA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../fsxa-pwa/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../fsxa-ui/4.1.0/index.html">FSXA-UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../fsxa-ui/4.1.0/index.html">4.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../../../fsxa-ui/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../headless/1.0/index.html">Headless</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../headless/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../../component-b/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/pahl-espirit/ecom/edit/main/modules/SAP_Classic/pages/EN/fs-installation/schedule/custom-process.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect3">
<h4 id="custom-process"><a class="anchor" href="#custom-process"></a>Expansion of the standard process</h4>
<div class="paragraph">
<p>The previously described standard process for the release and deployment of content can be modified and expanded as required on a project-specific basis.
This chapter describes possible use cases and contains information on how to use them.</p>
</div>
<div id="preview-page-attributes" class="dlist">
<dl>
<dt class="hdlist1">Preview of changes to {ccloud}-specific page attributes</dt>
<dd>
<p>Editorial changes to content or product detail pages are automatically transferred to <em>Preview {c}</em>, which renders them available for display in the preview.
However, changes to Commerce Cloud-specific page attributes of content pages are processed in a different way:
These changes are not stored in <em>{c}</em>, but are transferred to the staged content catalog during <a href="#install_schedule">deployment</a>.</p>
<div class="paragraph">
<p>If these changes need to be reflected in the preview, it must be possible to manually transfer them to the staged content catalog.
To do so, the system requires a schedule which, like the <a href="#install_schedule">deployment schedule</a>, is comprised of a generation operation and the subsequent import process.
In such cases, instead of a <em>{c}</em> full generation, a <em>{c}</em> partial generation must be selected.
The update logic for the import process must also contain an unapproval of the content page and must <strong>not</strong> trigger synchronization.</p>
</div>
</dd>
<dt class="hdlist1">Approval of a content page during page release</dt>
<dd>
<p>Using the <a href="#install_workflow">release workflow</a>, the user can execute an automatic approval of the corresponding {ccloud} page in the staged content catalog in parallel to the {fs} release process.
To achieve this, the workflow must be modified to call up the relevant <a href="#install_schedule">deployment schedule</a>.
In order to update only the single released page, the <em>{c}</em> full generation must be replaced with a <em>{c}</em> partial generation.
As is the case with the <a href="#preview-page-attributes">preview of changes to {ccloud}-specific page attributes</a>, the update logic must <strong>not</strong> trigger synchronization.</p>
</dd>
<dt class="hdlist1">Hot deployment</dt>
<dd>
<p>A hot deployment - the publication of a single page - works in the same way as a standard <a href="#install_schedule">released page deployment</a>.
However, instead of a delta or full generation, only a partial generation of the page to be deployed should be carried out.</p>
</dd>
</dl>
</div>
<div id="direct_release" class="dlist">
<dl>
<dt class="hdlist1">Direct publication in the online content catalogue</dt>
<dd>
<p>The described <a href="#install_schedule">deployment schedule</a> updates both the Staged and the Online Content Catalog.
Therefore it triggers an approval and synchronization of the affected content pages.
Alternatively, it is also possible to trigger only an approval and a direct publication into the online content catalog.
In this case, automatic synchronization is not necessary.</p>
<div class="paragraph">
<p>The following steps are required to implement direct publication:</p>
</div>
<div class="paragraph">
<p>In the first step the sync definition must be removed within the <a href="#app_sync">schedule action <code>Content Page Approval &amp; Sync Definition</code></a>.
For this purpose, the update logic must be adapted as shown in the code snippet.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Due to the direct publication and the adaptation of the update logic, the automatic synchronization of both content catalogs will be omitted.
For this reason, it must be ensured on a project-specific basis that the contents of both catalogs remain identical.
Otherwise, divergences are unavoidable.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="title">Update logic for the approval of a content page</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-HTML hljs" data-lang="HTML">import com.espirit.moddev.contentconnect.sap.module.ServiceFactory;
import com.espirit.moddev.contentconnect.sap.module.synchronization.ContentPageAdditionalUpdate;
import com.espirit.moddev.contentconnect.sap.module.catalogs.cmsitem.CMSItemService;
import com.espirit.moddev.contentconnect.sap.module.catalogs.cmsitem.CMSItem;

contentPageAdditionalUpdate = new ContentPageAdditionalUpdate() {
   updateCMSContentPage(cmsContentPage, pageRef) {
      cmsItemService = ServiceFactory.getCMSItemService(context);

      context.logInfo("Approving content page " + cmsContentPage.getUid() + "..");

      // Approving CMSContentPage
      cmsContentPage.setApprovalStatus("APPROVED");
      updatedCMSContentPageOpt = cmsItemService.updateCMSContentPage(cmsContentPage);

      if(!updatedCMSContentPageOpt.isPresent()) {
         context.logWarning("Approving content page " + cmsContentPage.getUid() + " failed!");
      }
   }
};

context.setProperty("sapcc_additional_contentpage_update", contentPageAdditionalUpdate);</code></pre>
</div>
</div>
<div class="paragraph">
<p>An identical, second schedule is created by a subsequent duplication of the existing schedule.
Without any further configuration, both schedules would write into the Content Catalog that is selected as the <code>Content Catalog Version</code> in the <a href="#configContent">Content tab</a> of the project component.
In the reference project, this is the Staged Content Catalog.</p>
</div>
<div class="paragraph">
<p>In order for the second schedule to write into the online content catalog, the parameter <code>catalogVersion</code> must be added to the properties of the schedule action <code>SAPCC - Bulk Update</code> and configured with the value <code>Online</code>.
If the value is missing or the configuration is incorrect, the bulk update terminates and an exception occurs.
Otherwise, the log contains the information about which content catalog is used for deployment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../../_images/schedule-parameter.png" alt="schedule parameter">
</div>
<div class="title">Figure 1. Parameter catalogVersion</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If, as described in this section, writing to the Online Content Catalog is done by a separate schedule, the <em>{c}</em> generation must be adjusted in the schedule that writes to the Staged Content Catalog.
This must fill the <em>Preview {c}</em> equivalent to writing to the Staged Content Catalog.
Information on the necessary adaptation of the <em>{c}</em> generation is contained in the <em>Initialize CaaSGeneration</em> section of the <em>{caasfsmdocen}</em>.</p>
</div>
</td>
</tr>
</table>
</div>
</dd>
</dl>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
