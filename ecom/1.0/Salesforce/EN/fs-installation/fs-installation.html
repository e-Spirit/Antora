<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: CrownSpirit Documentation</title>
    <link rel="canonical" href="https://e-spirit.github.io/Antora/ecom/1.0/Salesforce/EN/fs-installation/fs-installation.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../_'</script>
    <link rel="icon" href="../../../../../_/img/shortcut-icon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://e-spirit.github.io/Antora">CrownSpirit Documentation</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Cloud</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Headless</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">E-Commerce</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spryker/index.html">Spryker</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spartacus/index.html">Spartacus</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">FirstSpirit</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=editors">Editors</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=developers">Developers</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=administrators">Administrators</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Crownpeak</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ecom" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">E-Commerce</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Spryker/index.html">Spryker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spryker/EN/spryker-installation/spryker-installation.html">Spryker - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spryker/EN/fs-installation/fs-installation.html">FirstSpirit - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spryker/EN/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spryker/EN/use-cases/use-cases.html">Use Cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spryker/EN/legal-notice.html">Legal Notice</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spartacus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Spartacus/chapters/introduction.html">Main Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/sapcc-installation/sapcc-installation.html">Spartacus - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/fs-installation/fs-installation.html">FirstSpirit - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/use-cases/use-cases.html">Use Cases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spartacus/FS_Connect_SAP_hl_ServeradminManual_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../index.html">Salesforce</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SAP Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../SAP_Classic/firstspiritconnect-sap-documentation_EN.html">Main Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../SAP_Classic/firstspiritconnect-sap-admindoc_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">E-Commerce</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../component-b/1.0/index.html">CrownSpirit Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../component-b/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">E-Commerce</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../fsxa-pwa/1.3.0/index.html">FSXA-PWA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../fsxa-pwa/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../fsxa-ui/4.1.0/index.html">FSXA-UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../fsxa-ui/4.1.0/index.html">4.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../../fsxa-ui/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../headless/1.0/index.html">Headless</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../headless/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../component-b/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/pahl-espirit/ecom/edit/main/modules/Salesforce/pages/EN/fs-installation/fs-installation.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="_fs_installation_and_configuration"><a class="anchor" href="#_fs_installation_and_configuration"></a>{fs} - Installation and configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Various components must be installed and configured in order to use the functions of the <em>{modulname}</em> module.
The following sub-chapters explain the necessary steps for installing and configuring components in {fs}.</p>
</div>
<div class="sect2">
<h3 id="install"><a class="anchor" href="#install"></a>Installing the modules</h3>
<div class="paragraph">
<p>The <em>{modulname}</em> delivery contains three modules that must be added to the {fs} server.
To install the modules, open the <code><strong>{manager}</strong></code> and select <code><strong>menu:Server properties[Modules]</strong></code>.</p>
</div>
<div id="modules" class="imageblock">
<div class="content">
<img src="../../_images/modules.png" alt="modules">
</div>
<div class="title">Figure 1. Module management in the server properties</div>
</div>
<div class="paragraph">
<p>The main panel contains a list of all the modules installed on the {fs} server.
Click btn:[Install], then select the <em>contentconnect-fsm-&lt;version number&gt;.fsm</em> file provided first, followed by the <em>WebDavDeployment-&lt;version number&gt;.fsm</em> and <em>jstl.fsm</em> files.
Each time you make a selection, click btn:[Open] to confirm it.
Once installation has been successfully completed, the folders <code>{modulname}</code>, <code>WebDavDeployment</code> and <code>JSTL</code> are added to the list.
Each of these must be given <code>All permissions</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The JSTL module only needs to be installed on the {fs} Server if JSTL has not yet been integrated on the server in any other way.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>After any module installation or update, the {fs} server needs to be restarted.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_using_webdav_with_https"><a class="anchor" href="#_using_webdav_with_https"></a>Using WebDAV with https</h3>
<div class="paragraph">
<p>To use the WebDAV server with <code>https</code> instead of <code>http</code>, it is not necessary to perform any additional configuration work.
However, a local certificate authority managed by the company is normally used for <code>https</code>.
The certificate in question, including the entire chain up to the certificate on the WebDAV server, must be made available to the {fs} server&#8217;s JVM.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The JVM expects public certificates of this kind to be in the form of a <code>PKCS12</code> file or a <code>JKS</code> file.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Using the command below, import the public root or intermediate certificates into a <code>JKS</code> file and select btn:[Yes] in answer to the question whether the certificate is to be trusted.
You must repeat this process for each certificate.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>keytool -import -file cert1.crt -keystore truststore.jks –storepass changeit</code></pre>
</div>
</div>
<div class="paragraph">
<p>Copy the <code>Trust Store</code> that is generated into the <code><strong>menu:firstspirit5[conf]</strong></code> directory of your {fs} server and add the following lines to the file <code><strong>menu:firstspirit5[conf&gt;fs-wrapper.conf]</strong></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>wrapper.java.additional.100=-Djavax.net.ssl.trustStore=conf/truststore.jks
wrapper.java.additional.101=-Djavax.net.ssl.trustStorePassword=changeit
wrapper.java.additional.102=-Djavax.net.ssl.trustStoreType=JKS</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The parameters must be activated by restarting the {fs} Server.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If the WebDAV server is expecting mutual SSL authentication, you must use the following calls to create and sign a client certificate as a first step.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>openssl genrsa -out private.key 2048
openssl req -new -key private.key -out request.csr</code></pre>
</div>
</div>
<div class="paragraph">
<p>The file <code>request.csr</code> is sent to the certificate authority, which responds with the file <code>cert.crt</code>.
The private key, the public certificate, and the certificate from the certificate authority must then be collected in a <code>Key Store</code> to be read by the <code>JVM</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>cd firstspirit5/conf
openssl pkcs12 -export -in public.crt -inkey private.key \
-out clientcert.p12 -CAfile authority.crt</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the certificate chain consists of one or more intermediate certificates, you can import them via <code>keytool</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>keytool -import -file intermediate1.crt -trustcacerts \
-keystore clientcert.p12 -storepass changeit</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>Key Store</code> can be transferred to the <code>JVM</code> of the {fs} Server by adding the following lines to <code><strong>menu:firstspirit5[conf&gt;fs-wrapper.conf]</strong></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code>wrapper.java.additional.103=-Djavax.net.ssl.keyStore=conf/clientcert.p12
wrapper.java.additional.104=-Djavax.net.ssl.keyStorePassword=changeit
wrapper.java.additional.105=-Djavax.net.ssl.keyStoreType=PKCS12</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_project_import"><a class="anchor" href="#_project_import"></a>Project import</h3>
<div class="paragraph">
<p>A part of the   included in the delivery is the reference project <em>{projectname}</em>, which must be installed on the {fs} server.
To do this, open the import dialog in the <code><strong>{manager}</strong></code> via the menu item <code><strong>menu:Project[Import]</strong></code> and click the {local} button to select the <code>{modulname}ReferenceProject.tar.gz</code> file from your local data system.
Then assign a project name and description and confirm the import with btn:[Yes].
After successful installation, the project is added to the list in the main panel (see figure <a href="#importedproject">Imported project in the {manager}</a>).</p>
</div>
<div id="importedproject" class="imageblock">
<div class="content">
<img src="../../_images/importedproject.png" alt="importedproject">
</div>
<div class="title">Figure 2. Imported project in the {manager}</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>In addition to the standard groups <code>Everyone</code> and <code>Administrators</code>, there are four further user groups in the reference project: <code>Editors</code>, <code>ChiefEditors</code>, <code>Developers</code> and <code>ProjectAdmins</code>.
The groups have different rights, which are selected according to their tasks and defined for the different stores.
Users outside these groups are not allowed to use the reference project by default.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="pcomp"><a class="anchor" href="#pcomp"></a>Configuring the project component</h3>
<div class="paragraph">
<p>A project-specific configuration is required in order to use the <em>{modulname}</em> module.
It is set up using the project component, which is already added to the reference project supplied.</p>
</div>
<div class="paragraph">
<p>To configure the project component, open the <code><strong>{manager}</strong></code> and select <code><strong>menu:Project properties[Project components]</strong></code>.
A list of all existing project components is displayed in the main panel.
Select the entry <code>{modulname} Project Configuration</code> and click btn:[Configure] to open the associated dialog (see figure <a href="#config">Configuration dialog for the project component</a>).</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The subsequent configuration is used by the module services.
The service and all running clients must be restarted each time the configuration is changed.
Otherwise, the change in question will not be applied either to the services or to the clients.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="config" class="imageblock">
<div class="content">
<img src="../../_images/config.png" alt="config">
</div>
<div class="title">Figure 3. Configuration dialog for the project component</div>
</div>
<div id="project-app-config-base-url" class="dlist">
<dl>
<dt class="hdlist1">Base URL</dt>
<dd>
<p>Start by entering the <code>Base URL</code>, which is derived from the URL of the {ccloud} instance and the ID of the site being used:</p>
<div class="paragraph">
<p><code>https://&lt;SUBDOMAIN INSTANCE&gt;.demandware.net/s/&lt;SITE ID&gt;</code></p>
</div>
<div class="paragraph">
<p>Based on this structure, a unique connection between the {fs} project and the {ccloud} site is always guaranteed.</p>
</div>
<div class="paragraph">
<p>The <code>Base URL</code> field is a mandatory field.</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To avoid problems concerning the certificate, it must be ensured that the subdomain does not contain any periods in its name.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="clientid" class="dlist">
<dl>
<dt class="hdlist1">Client ID</dt>
<dd>
<p>The <code>Client ID</code> is also a mandatory field.
This is required in order to be able to use the <code>Open Commerce Shop API</code>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>Client ID</code> and the <code>Base URL</code> are essential for the connection between {ccloud} and {fs}.
If one of the two pieces of information is incorrect or is not available, then the relevant report for the product search is hidden in both {fs} Clients.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Password</dt>
<dd>
<p>The components of the <em>{modulname}</em> API require password-based authentication against {ccloud}.
For this reason, a password that is defined when the API client is registered with {ccloud} is required in addition to the client ID.</p>
</dd>
<dt class="hdlist1">Refinements</dt>
<dd>
<p>Refinements that improve product searches are defined in this configuration field.
Refinements are entered as key value pairs separated using commas.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Up to the first nine key value pairs entered are used ({ccloud} will not accept more than nine refinements).</p>
</div>
<div class="paragraph">
<p>The format of the values of the key value pairs matches the format {ccloud} expects for refinement values.
Both multiple values and sets of values can be entered for a refinement:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>cgid=new-arrivals|electronics</code></p>
</li>
<li>
<p><code>price=(0..100)</code></p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since a refinement is also used for category searches, two special cases need to be considered:</p>
</div>
<div class="paragraph">
<p>In the first case,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the product search is filtered by a category and</p>
</li>
<li>
<p>the configuration contains nine refinement definitions,</p>
</li>
<li>
<p><strong>none</strong> of which is the <code>cgid</code> category refinement.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, there are a total of ten refinement definitions, which is not permitted.
Therefore, one of the refinements from the configuration is ignored so that the product search can be filtered by a category.</p>
</div>
<div class="paragraph">
<p>In the second case,</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the product search is also filtered by a category and</p>
</li>
<li>
<p>the configuration contains the <code>cgid</code> category refinement.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In this case, there is a duplicate definition for the <code>cgid</code> category refinement:
one from the module configuration and one from the product search; the latter is used.
The value from the configuration is then used as the default value. It can be overwritten by the editor.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Locale</dt>
<dd>
<p>The <code>Locale</code> identifies the language and region of the current project.
A maximum of one ID for an active locale that is permitted for storefront requests in the site configured at the top of the dialog may be entered.
If the field is left blank, the <code>locale</code> parameter will not be used in storefront requests.</p>
</dd>
<dt class="hdlist1">Auth User</dt>
<dd>
<p>If access restriction is activated in {ccloud}, the <code>storefront</code> user must be specified in this field.</p>
</dd>
<dt class="hdlist1">Auth Password</dt>
<dd>
<p>The password belonging to the <code>storefront</code> user is specified in this field.</p>
</dd>
</dl>
</div>
<div id="product_page_template_mapping" class="dlist">
<dl>
<dt class="hdlist1">Product Page Template Mapping</dt>
<dd>
<p>One of the functions supported by the product report is the user-friendly creation of product pages, which use the page template <em>Product Detail Page</em> in the reference project.
To enable this, this configuration field allows {sf} render templates to be mapped to {fs} page templates.
The following rules apply here:</p>
<div class="ulist">
<ul>
<li>
<p>The field contains either no content at all or one or more mappings.</p>
</li>
<li>
<p>If the field remains empty, the use of product pages in the project is disabled.</p>
</li>
<li>
<p>Mappings are specified using a list separated by commas: <strong>&lt;mapping&gt;,&lt;mapping&gt;</strong></p>
</li>
<li>
<p>Each mapping is arranged as follows: <strong>&lt;isml_template&gt;:&lt;fs_template&gt;</strong></p>
</li>
<li>
<p>To configure a page template for all ISML templates that do not have an explicit mapping, the following form must be used: <strong>default:&lt;fs_template&gt;</strong></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="default_folder" class="dlist">
<dl>
<dt class="hdlist1">Default Folder (Product Pages)</dt>
<dd>
<p>To create a new product page, it is essential to know where the page is to be integrated into the structure.
The reference name of the <em>Product Pages</em> structure folder has already been entered here.
All new product pages within the reference project are created in this folder.
If the field is left empty, the editor must select a menu level.</p>
</dd>
<dt class="hdlist1">Editable Folder (Product Pages)</dt>
<dd>
<p>This checkbox makes it possible to specify whether an editor can change the selection made in the <code>Default Folder (Product Pages)</code> field.
The function is activated initially.
If it is then deactivated, the corresponding input component is hidden in the dialog for <a href="#create_detailpage">creating a category or product page</a>.
In this case, it is not possible for the editor to select or change the menu item for a newly created category or product page.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The field <code>Default Folder (Product Pages)</code> and the checkbox <code>Editable Folder (Product Pages)</code> are ignored if the field <code>Product Page Template Mapping</code> is empty.
If, instead, a mapping is defined, it is <strong>mandatory</strong> that the reference name of a structure folder is specified or that the checkbox is activated.
Otherwise, it will not be possible to create new product pages due to the lack of assignment to a menu level, and errors will occur.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="cagegory_page_template_mappings" class="dlist">
<dl>
<dt class="hdlist1">Category Page Template Mappings</dt>
<dd>
<p>The mapping of page templates can be configured using this configuration field for the creation of <a href="#detail_pages">category pages</a> via the <a href="#category_report">category report</a>.
The following rules apply here:</p>
<div class="ulist">
<ul>
<li>
<p>The field contains either no content at all or one or more mappings.</p>
</li>
<li>
<p>If the field remains empty, the use of category pages in the project is disabled.</p>
</li>
<li>
<p>Mappings are specified using a list separated by commas: <strong>&lt;mapping&gt;,&lt;mapping&gt;</strong></p>
</li>
<li>
<p>Each mapping is arranged as follows: <strong>&lt;isml_template&gt;:&lt;fs_template&gt;[:fallback_category]</strong></p>
</li>
<li>
<p>The third part of the mapping is optional and is used to specify a <a href="#hidden_categories_note">fallback category</a> for category pages that are based on the specified ISML template</p>
</li>
<li>
<p>To configure a page template and an optional fallback category for all ISML templates that do not have an explicit mapping, the following form must be used: <strong>default:&lt;fs_template&gt;[:fallback_category]</strong></p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div id="hidden_categories_note" class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Categories can be marked as offline within {ccloud}.
These offline categories are not delivered via the storefront, whereby no preview can be generated for them.
To make it possible to also maintain category pages for offline categories via the {fs} report, fallback categories must be specified for the associated ISML templates.
Within the preview for an offline category page, this is then replaced by the configured fallback category.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We recommend using separate {fs} templates for product pages and category pages.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Default Folder (Category Pages)</dt>
<dd>
<p>In the same way as with product pages, for each new category page it is essential to know where the page is to be integrated into the structure.
The reference name of the <em>Category Pages</em> structure folder has already been entered here.
All new category pages within the reference project are created in this folder.
If the field is left empty, the editor must select a menu level.</p>
</dd>
<dt class="hdlist1">Editable Folder (Category Pages)</dt>
<dd>
<p>In the same way as with the <code>Editable Folder (Product Pages)</code> checkbox, here it is possible to specify whether editors can change the selection made in the <code>Default Folder (Category Pages)</code> field.
The function is activated initially.
If it is then deactivated, the selection option is hidden in the dialog for <a href="#create_detailpage">creating a category page</a>.
In this case, it is not possible for the editor to select or change the menu item for a new page.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The field <code>Default Folder (Category Pages)</code> and the checkbox <code>Editable Folder (Category Pages)</code> are ignored if the field <code>Category Page Template Mapping</code> is empty.
If, instead, a mapping is defined, it is <strong>mandatory</strong> that the reference name of a structure folder is specified or that the checkbox is activated.
Otherwise, it will not be possible to create new category pages due to the lack of assignment to a menu level, and errors will occur.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="template_instantiation_script_uid" class="dlist">
<dl>
<dt class="hdlist1">Template Instantiation Script Uid</dt>
<dd>
<p>Select a script to be executed before and after <a href="#detail_pages">category or product pages</a> are created in this configuration field (the selection of a script is optional).
The <em>create_sfcc_item_wizard</em> script specified is used to execute project-specific actions, which are required to generate the preview.
In the reference project, it marks the created category or product page as translated for all languages.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Please note that only the code from the HTML channel of the script is executed.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">View Type Priority</dt>
<dd>
<p>Images of products from {ccloud} are always provided in a range of sizes, but an image will not necessarily have been stored for every size.
For this reason, the <code>View Type Priority</code> has been provided so that you can define which image sizes you wish to incorporate, separating the information you enter with commas.</p>
<div class="paragraph">
<p>In the case shown in the figure <a href="#config">Configuration dialog for the project component</a>, the <code>medium</code> image associated with each product is identified and is used if it exists.
If there is no medium image, the <code>large</code> image is called up, followed by the <code>small</code> one if necessary.</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As this is not a mandatory input field, it may therefore remain empty if you do not wish to define an order of priority.
If this is the case, search results from a product query will be shown without an image.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Image Service Base URL</dt>
<dd>
<p>{ccloud} provides what is known as an <a href="https://documentation.demandware.com/DOC2/topic/com.demandware.dochelp/ImageManagement/ImageTransformationService.html"><code>Image Service</code></a>.
If you wish to use it, you must specify the URL of the Image Service in the form <code>http[s]://&lt;image server host name&gt;</code> at this point.
Product images are then called up via the Image Service.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Specifying the <code>Image Service Base URL</code> is optional.
However, if the field is filled with a URL, then this entry must not contain any errors; otherwise, the relevant report for the product search is hidden in both {fs} Clients.
This still applies even if the <code>Client ID</code> and the <code>Base URL</code> are correct (see above).</p>
</div>
</td>
</tr>
</table>
</div>
<div id="category-search" class="dlist">
<dl>
<dt class="hdlist1">Use Category Search</dt>
<dd>
<p>Next you must decide whether the reports for products and categories should provide filtering on categories in addition to the text search field.
The corresponding checkbox <code>Use Category Search?</code> is deactivated by default.
In this case, the category filter is not applied in the context of the product or category search.
The associated dropdown list is hidden in the report.
If filtering according to category is required, the checkbox must be activated.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Filtering by category differs depending on the report used.
In the report for the product search, filtering is possible across all categories.
In the report for the category search, however, filtering is only possible via the top-level categories.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="show_report" class="dlist">
<dl>
<dt class="hdlist1">Show Category Report</dt>
<dd>
<p>This checkbox can be used to control the display of the category report.
The checkbox is deactivated by default (i.e., only the report for product searches is active).</p>
<div id="category_report" class="imageblock">
<div class="content">
<img src="../../_images/category_report.png" alt="category report">
</div>
<div class="title">Figure 4. Category report</div>
</div>
</dd>
<dt class="hdlist1">Test Configuration</dt>
<dd>
<p>Click the {testConf} button to check the entries that have been entered.
For this, the <code>Client ID</code>, the <code>Base URL</code> and - if available - the <code>Image Service Base URL</code> as well as the configurations for the product and category pages are taken into account.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="wcomp"><a class="anchor" href="#wcomp"></a>Adding web components</h3>
<div class="paragraph">
<p>Two web components are required for the <code>Preview</code> and for <code>{wc}</code> and have already been added to the reference project supplied.
Nevertheless, they still need to be installed on an active web server.
To do this, open the <code><strong>{manager}</strong></code> and select <code><strong>menu:Project properties[Web components]</strong></code>.</p>
</div>
<div class="paragraph">
<p>Inside the main panel, various tab pages are visible.
Each tab page contains a list of the existing web components.
The list contains the following entries both for the <code>Preview</code> as well the <code>{wc}</code> (see figure <a href="#webcomponents">Web components in the project properties</a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>{modulname} Web Component</code></p>
</li>
<li>
<p><code>FS_JSTL_WebApp</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Select a <code>Web server</code> on both tab pages via the selection box and start the installation by clicking the btn:[Install] button.
After successful installation, a dialog opens, in which the activation of the <code>Web server</code> must be confirmed.</p>
</div>
<div class="paragraph">
<p>More detailed information on how to add web components is available in the <em>{fsadmindoc_en}</em>.</p>
</div>
<div id="webcomponents" class="imageblock">
<div class="content">
<img src="../../_images/webcomponents.png" alt="webcomponents">
</div>
<div class="title">Figure 5. Web components in the project properties</div>
</div>
</div>
<div class="sect2">
<h3 id="webconf"><a class="anchor" href="#webconf"></a>Configuration of the web component</h3>
<div class="paragraph">
<p>Part of the web component of the <em>{modulname}</em> module are the {proxy} and the {filter}.
Both components can be configured via the <code>web.xml</code> and are described in more detail in the following two chapters.</p>
</div>
<div class="sect3">
<h4 id="previewproxy"><a class="anchor" href="#previewproxy"></a>{proxy}</h4>
<div class="paragraph">
<p>If problems with cross-origin requests occur during the preview due to the same-origin policy of modern web servers, then these can be remedied by using the {proxy} included in the <em>{modulname}</em> module.</p>
</div>
<div class="paragraph">
<p>To do this, the calls to the resources concerned must be routed via the {proxy}.
The <a href="#uc_preview_proxy">Preview</a> chapter explains how this is done in the project.</p>
</div>
<div class="paragraph">
<p>The {proxy} is configurable via the <code>web.xml</code> with the following parameter:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">connection.keepalive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">60</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration of maintaining a connection within the {proxy} in seconds. Too high values may cause problems when loading resources.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>An example snippet of the <code>web.xml</code>, in which the {proxy}'s parameter is configured and the preconfigured URL path has been adjusted, might look as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example web.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;servlet&gt;
    &lt;servlet-name&gt;ContentConnectPreviewProxy&lt;/servlet-name&gt;
    &lt;servlet-class&gt;com.espirit.moddev.demandware.preview.proxy.ProxyServlet&lt;/servlet-class&gt;
    &lt;load-on-startup&gt;0&lt;/load-on-startup&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;connection.keepalive&lt;/param-name&gt;
      &lt;param-value&gt;120&lt;/param-value&gt;
   &lt;/init-param&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;ContentConnectPreviewProxy&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/assets/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="previewfilter"><a class="anchor" href="#previewfilter"></a>{filter}</h4>
<div class="paragraph">
<p>The <code>{modulname} {filter}</code> determines the necessary information for displaying a page in the <a href="#uc_preview">{fs} preview</a>.
In the slot-based approach, it identifies the correct storefront URL for this purpose, downloads the HTML on the basis of this URL, and substitutes the slots it contains with the corresponding editorial content.
If the <code>CI API</code> is being used, however, it has the Velocity fragments maintained in {fs} evaluated on the {sf} side, and displays the result at the corresponding point on the page in the <a href="#uc_preview">{fs} preview</a>.</p>
</div>
<div class="paragraph">
<p>To carry out these steps, the filter requires some information that can be configured via various parameters in the <code>web.xml</code> of the <a href="#wcomp">added web components</a> (for the Preview as well as {wc}).
This information relates to various aspects, which can be divided into four groups.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>web.xml</code> of the <a href="#wcomp">added web component</a> added in the tab <code>preview</code> requires the adjustment of the parameter <code>dispatcher</code>.
By default, the <code>web.xml</code> contains the value <code>FORWARD</code> for this parameter.
However, in the case of the preview in the {jc}, it requires the value <code>REQUEST</code> and must be replaced accordingly.</p>
</div>
<div class="listingblock">
<div class="title">Adjustment in the web.xml for the preview in the {jc}</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;filter-mapping&gt;
   &lt;filter-name&gt;ContentConnectPreviewFilter&lt;/filter-name&gt;
   &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
   &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
&lt;/filter-mapping&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beyond that, a configuration of the individual parameters is only necessary if their default values do not match the project-specific conditions.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Storefront URL parameters</strong></p>
</div>
<div class="paragraph">
<p>As described previously, the <code>{filter}</code> determines the necessary information on the {sf} side - both in the slot-based approach and when using the <code>CI API</code>.
It then displays this information in the <a href="#uc_preview">{fs} preview</a>.
To do this, a project-specific storefront URL is required.
As this is maintained in the <a href="#project_settings">project settings</a>, the <code>{filter}</code> requires the associated input component to be specified for its query.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.url.baseUrlFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontUrlBaseUrl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component for specifying the storefront&#8217;s base URL, which is extended with the page type and the ID of the element to be displayed (e.g., product, category, or asset ID).
The component is maintained in the project settings.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The syntax for the storefront base URL can be found in the <a href="https://documentation.demandware.com/DOC2/topic/com.demandware.dochelp/SearchEngineOptimization/DigitalURLSyntaxWithoutSEO.html">menu:Merchandising Your Site[Search Engine Optimization&gt;URL Syntax&gt;Salesforce B2C Commerce URL Syntax Without SEO</a>] chapter of the {sf} {ccloud} documentation.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As a value of the input component <code>ps_storefrontUrlBaseUrl</code>, only up to the locale, <strong>not</strong> the entire URL must be entered within the <a href="#project_settings">project settings</a>.</p>
</div>
<div class="paragraph">
<p>E.g.: https://www.mystore.com/on/demandware.store/​Sites-YourShopHere-Site/</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Changes to the <a href="#project_settings">project settings</a> do not take effect straight away, as they are saved in the session of the user.
They require the client to be restarted.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><strong>Storefront Crop Marks parameters</strong></p>
</div>
<div class="paragraph">
<p>The placeholders included in the editorial content consist of a start as well as an end comment and have the format <code>&lt;!-- CMS-&lt;IDENTIFIER&gt;-START -&#8594;</code> or <code>&lt;!-- CMS-&lt;IDENTIFIER&gt;-END -&#8594;</code> by default.
However, the use of individual affixes can be activated via a toggle in the <a href="#project_settings">project settings</a>, which must be added if necessary.
In this case, the default values are overwritten and specific prefixes and suffixes are used instead.
In order to grant the <code>{filter}</code> access to this information, it requires the associated input components to be specified.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cropMarks. customAffixes.enabledFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCropMarksCustomAffixesEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The toggle in the project settings for (de)activating the use of individual affixes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cropMarks. opening.prefixFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCropMarksOpeningPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying a prefix for the start comment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cropMarks. opening.suffixFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCropMarksOpeningSuffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying a suffix for the start comment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cropMarks. closing.prefixFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCropMarksClosingPrefix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying a prefix for the end comment.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cropMarks. closing.suffixFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCropMarksClosingSuffix</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying a suffix for the end comment.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Storefront protection parameters</strong></p>
</div>
<div class="paragraph">
<p>It is possible to protect the connection to {ccloud} via an authentication.
This can be (de)activated in {sf} and must be applied to {fs} via the corresponding toggle in the <a href="#project_settings">project settings</a>.
If it is activated, the required access data must also be specified.
The <code>{filter}</code> must be able to access this information and therefore requires the associated input components to be specified.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.protection.enabledFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontProtectionEnabled</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for (de)activating the authentication for the storefront URL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.protection.userFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontProtectionUser</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for registering the storefront user.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.protection.passwordFormField</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontProtectionPassword</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for the password of the storefront user.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Storefront downloader parameters</strong></p>
</div>
<div class="paragraph">
<p>In addition to the other parameters, which are primarily used to determine the correct storefront URL, in the slot-based approach it must be possible to control the behavior of the <code>{filter}</code> while the HTML of the corresponding page is downloading.
For this, it has different parameters, which can be maintained in the <a href="#project_settings">project settings</a>.
The <code>{filter}</code> must be able to access this information and therefore requires the associated input components to be specified.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The storefront downloader parameters are used to initialize the filter in the slot-based approach.
As a result, they have a fixed fallback value for cases with a missing or empty input component.</p>
</div>
</td>
</tr>
</table>
</div>
<table id="storefront-download-parameter" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.downloader.maxConnections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontDownloaderMaxConnections</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the maximum permissible number of parallel connections to Storefront.<br>
The fallback value is 100.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.downloader.socketTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontDownloaderSocketTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the time span (in milliseconds) in which a response from Storefront is expected.<br>
The fallback value is 10000.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.downloader.retryCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontDownloaderRetryCount</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the maximum number of connection attempts.<br>
The fallback value is 3.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The use of the following two parameters is only recommended in exceptional cases, as they bypass the certificate check for <code>https</code> requests.
This may be necessary if certificate errors prevent the preview from being displayed and the problem can not be resolved on the server side.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.downloader.certificatesCheck</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Setting this parameter to <code>false</code> disables certificate checks for <code>https</code> requests.
As a result, all <code>https</code> requests for viewing the preview will be blocked initially.
To allow requests against individual pages, the host name of the corresponding pages must be entered in the <code>sslWhitelist</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.downloader.sslWhitelist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">empty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the certificate check is deactivated, the host names to be excluded from the blocking are maintained via the <code>sslWhitelist</code>.
Several host names have to be entered as a comma-separated list.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Storefront Cache Parameter</strong></p>
</div>
<div class="paragraph">
<p>The HTML of slot-based pages downloaded by the <code>{filter}</code> is stored in a cache so that it does not have to be retrieved from the {ccloud} every time it is called.
Such a cache exists across sessions for each project on the {fs} server.
This cache has some parameters that can be maintained in the <a href="#project_settings">project settings</a>.
The <code>{filter}</code> must be able to access this information and therefore needs to specify the associated input components.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Like the <a href="#storefront-download-parameter">downloader parameters</a>, the cache parameters are used to initialize the filter in the slot-based approach.
For this reason they have a fixed fallback value in case of a missing or empty input component.</p>
</div>
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 19.2307%;">
<col style="width: 19.2307%;">
<col style="width: 61.5386%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cache.maxEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontDownloaderMaxCacheEntries</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the maximum number of elements in the cache.<br>
The fallback value is 500.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cache.refreshAfterWrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCacheRefreshAfterWrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the time span (in hours) until an element in the cache is marked as obsolete.<br>
The fallback value is 1.<br>
If an entry is marked as obsolete, it will be retrieved asynchronously from the {ccloud} at the next request.
Until this process is completed, the cache returns the obsolete entry, so there is no delay.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cache.expireAfterWrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCacheExpireAfterWrite</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying the time span (in hours) until an item in the cache is marked as removable.<br>
The fallback value is 24.<br>
If an entry is marked as removable, it can be displaced from the cache by new elements.
If an item is requested again after being displaced, it must be retrieved from the {ccloud} again.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">storefront.cache.excludePatterns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ps_storefrontCacheExcludePatterns</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input component in the project settings for specifying storefront URLs that should not be kept in the cache.
The URLs are specified in the form of a list of regular expressions.<br>
The fallback value is an empty list.<br>
Each element of the list component must have a text field named <code>st_storefrontCacheExcludePattern</code> containing the regular expression.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="paragraph">
<p>An example snippet of the <code>web.xml</code>, in which two parameters of the {filter} are configured, might look like as follows:</p>
</div>
<div class="listingblock">
<div class="title">Example web.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;filter&gt;
   &lt;filter-name&gt;ContentConnectPreviewFilter&lt;/filter-name&gt;
   &lt;filter-class&gt;com.espirit.moddev.demandware.preview.PreviewFilter&lt;/filter-class&gt;
   &lt;init-param&gt;
      &lt;param-name&gt;storefront.downloader.socketTimeout&lt;/param-name&gt;
      &lt;param-value&gt;ps_myCustomStorefrontDownloaderSocketTimeout&lt;/param-value&gt;
   &lt;/init-param&gt;
   &lt;init-param&gt;
      &lt;param-name&gt;storefront.downloader.retryCount&lt;/param-name&gt;
      &lt;param-value&gt;ps_myCustomStorefrontDownloaderRetryCount&lt;/param-value&gt;
   &lt;/init-param&gt;
&lt;/filter&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="resolutions"><a class="anchor" href="#resolutions"></a>Resolutions</h3>
<div class="paragraph">
<p>The reference project <em>{projectname}</em> has different sections, with which images can be integrated on the various pages.
It should be possible for the editor to crop the images to a certain image section.
This function is activated by specifying a resolution.</p>
</div>
<div class="listingblock">
<div class="title">Specifying the resolution</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">$CMS_REF(st_picture, resolution:"RESOLUTION")$</code></pre>
</div>
</div>
<div class="paragraph">
<p>For the reference project, the following resolutions are required: <code>BANNER</code>, <code>SLIDE</code>, <code>GRID_ELEMENT_HIGH</code>, <code>GRID_ELEMENT_WIDE</code>, <code>GRID_ELEMENT_SQUARE</code>, <code>IMAGE_MAP</code>, <code>ARTICLE_TEASER_IMAGE</code> and <code>TECHNOLOGY_IMAGE</code>.
They are already applied within the <code><strong>{manager}</strong></code> in the <code><strong>menu:Project properties[Resolutions]</strong></code> area and specified in the corresponding areas in the sections.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/resolutions.png" alt="resolutions">
</div>
<div class="title">Figure 6. Resolutions</div>
</div>
</div>
<div class="sect2">
<h3 id="schedule"><a class="anchor" href="#schedule"></a>Deployment schedule</h3>
<div class="paragraph">
<p>To transfer the content created in {fs} to the {ccloud} storage location, the reference project supplied has a schedule, which contains the actions specified below (see figure <a href="#actions">Generation schedule actions</a>).
A description of the individual actions is provided in the subsequent sub-chapters.</p>
</div>
<div class="paragraph">
<p>More information on creating a schedule is available in the <em>{fsadmindoc_en}</em>.</p>
</div>
<div id="actions" class="imageblock">
<div class="content">
<img src="../../_images/actions.png" alt="actions">
</div>
<div class="title">Figure 7. Generation schedule actions</div>
</div>
<div class="sect3">
<h4 id="sfccinitializer"><a class="anchor" href="#sfccinitializer"></a>Initialize SFCC deployment</h4>
<div class="paragraph">
<p>The first step is to initialize the deployment.
This involves setting up <a href="#sfcc_content_cleanup">content cleanup</a>.
While this is under way, a time stamp prior to the generation is created.
This time stamp is used by the <a href="#sfcccleanup">cleanup action</a> in the last step of the schedule to delete outdated assets and <a href="#slot_configuration">slot configurations</a>.
It is for this reason that the schedule contains the action <code>{sf} {ccloud} Initializer</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/sfcc_initializer.png" alt="sfcc initializer">
</div>
<div class="title">Figure 8. Schedule action</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To use <a href="#sfcc_content_cleanup">content cleanup</a>, the initialization must be the first action of the schedule.
Otherwise this can lead to inconsistencies in the data inventory.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="fdeployment"><a class="anchor" href="#fdeployment"></a>Content preparation - Full generation</h4>
<div class="paragraph">
<p>To deploy the content that is relevant to {ccloud}, it must be determined from the project first.
This requires a full generation to be carried out, generating all the referenced media in the correct resolution.
The full generation also generates the XML collectors initialized in the <a href="#project_settings">project settings</a> and fills them on the basis of the xmlCollector calls in the templates.</p>
</div>
<div class="paragraph">
<p>The schedule therefore has the generation action <code>Content Preparation</code> in whose <code><strong>Properties</strong></code> the following options are activated (see figure <a href="#content_preparation">Content preparation action</a>):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Perform FullGeneration</code></p>
</li>
<li>
<p><code>Clear generation directory beforehand</code></p>
</li>
<li>
<p><code>Generate Media in the generation directory</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The defined <code>Prefix for absolute paths</code> <code>/firstspirit</code> is required for the <a href="#wddeployment">WebDAV deployment</a> action.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is only possible to use the <a href="#wdmodule">WebDAV module</a> in conjunction with the default URL creator.
To generate the path, the entry <code>Default URLs</code> is therefore selected, which is absolutely essential at this point.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The template sets for all the languages present in the project are also selected on the <code><strong>Extended</strong></code> tab page.
In addition, the variable <code>dwre_xmlGeneration</code> is added, which contains the value <code>false</code>.
This is set to the value <code>true</code> in the subsequent <a href="#pdeployment"><code>XML Import File</code> actions</a> and ensures that the XML files for the <a href="#slot_configuration">slot configurations</a> and assets are only created once the generation is complete.
The XML template in the project controls the process of generating the XML file.</p>
</div>
<div id="content_preparation" class="imageblock">
<div class="content">
<img src="../../_images/content_preparation.png" alt="content preparation">
</div>
<div class="title">Figure 9. Content preparation action</div>
</div>
</div>
<div class="sect3">
<h4 id="pdeployment"><a class="anchor" href="#pdeployment"></a>XML import file - Partial generations</h4>
<div class="paragraph">
<p>{ccloud} expects all data that is transferred to it to be in the form of XML files.
For this reason, the information determined during the <a href="#fdeployment">full generation</a> must be read out of the XML collectors that are generated.
In this case, the information must instead be written to an XML file that has to be created each time.</p>
</div>
<div class="paragraph">
<p>For each XML collector initialized in the <a href="#project_settings">project settings</a>, the schedule provides another generation action.
In contrast to the <a href="#fdeployment"><code>Content Preparation</code></a> action, these are, however, partial generations.
In their <code><strong>Properties</strong></code>, the option <code>Execute partial generation for following start nodes</code> is therefore activated.
As a starting point, one of the page references based on the XML template is used (see figure <a href="#content_libary">Partial generation</a>).</p>
</div>
<div class="paragraph">
<p>The variable <code>dwre_xmlGeneration</code>, which contains the value <code>true</code>, is also added to the <code><strong>Extended</strong></code> tab page for each of these actions.
Together with the start node selected in each case, this ensures that the selected page reference is not generated until this point in time.
This means that all the information required for creating the XML file will be available when this happens and it will not be possible for any gaps to appear.
The XML template in the project controls the process of generating the XML file.</p>
</div>
<div id="content_libary" class="imageblock">
<div class="content">
<img src="../../_images/content_libary.png" alt="content libary">
</div>
<div class="title">Figure 10. Partial generation</div>
</div>
</div>
<div class="sect3">
<h4 id="wddeployment"><a class="anchor" href="#wddeployment"></a>WebDAV deployment</h4>
<div class="paragraph">
<p>Next, the XML files generated by means of the <a href="#pdeployment">partial generations</a> must be transferred to {ccloud}.
They are published via a script action, for which the following parameters are defined in their <code><strong>Properties</strong></code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/wdparameter.png" alt="wdparameter">
</div>
<div class="title">Figure 11. Properties</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">url</dt>
<dd>
<p>The <code>URL</code> specifies the host and the path on the WebDAV server.
It always has the following structure:</p>
<div class="paragraph">
<p><code>https://&lt;SUBDOMAIN INSTANCE&gt;.demandware.net/on/demandware.servlet/webdav/Sites/Impex/&#8230;&#8203;/&lt;PREFIX&gt;/&lt;SITE ID&gt;</code></p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The path points to the location where the XML file in question is expected to be during the import.
It must refer to an existing directory.<br>
Additionally, the prefix must be the same as the <code>Prefix for absolute paths</code> used in the <a href="#fdeployment">full generation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">user</dt>
<dd>
<p>A technical user who is authorized to use the WebDAV interface is required in order to transfer the data.
This user must have write permissions and must be specified by name here.</p>
<div class="paragraph">
<p>Further information about these rights can be found under <a href="https://documentation.b2c.commercecloud.salesforce.com/DOC2/topic/com.demandware.dochelp/Permissions/Creatingroles.html">menu:Administering Your Organization[Permissions, Users, and Roles&gt;Roles and Permissions&gt;Creating Roles and Assigning Permissions</a>] in the {sf} documentation.</p>
</div>
</dd>
<dt class="hdlist1">password</dt>
<dd>
<p>A password is also required for the user specified in the previous step.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The technical user is subject to the password conditions defined by {ccloud}, which require the password to be changed at least every quarter.
The parameter value must be changed each time this is carried out.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">mediaurl</dt>
<dd>
<p>The media folder generated during the generation process, and its content, must be transferred to a separate directory so that {ccloud} can perform the import.
This directory is defined using the parameter <code>mediaurl</code>.
The <code>mediaurl</code> always has the following structure:</p>
<div class="paragraph">
<p><code>https://&lt;SUBDOMAIN INSTANCE&gt;.demandware.net/on/demandware.servlet/webdav/Sites/Libraries/&lt;SITE ID|LIBRARY ID&gt;/default/&lt;PREFIX&gt;</code></p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>mediaurl</code> must refer to an existing directory.<br>
Furthermore, as with the <code>url</code>, the prefix must be the same as the <code>Prefix for absolute paths</code> used in the <a href="#fdeployment">full generation</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If a private library is being used, it is necessary to specify the site ID instead of the library ID in the path.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">srcprefixdir</dt>
<dd>
<p>If only one particular directory is transferred to {ccloud}, it can be specified in relation to the root node of the generation directory using the optional parameter <code>srcprefixdir</code>.
If the parameter is not defined, or no value is saved for it, the entire generation directory will be transferred.</p>
</dd>
<dt class="hdlist1">purge</dt>
<dd>
<p>This parameter is optional and may only have the value <code>true</code> or <code>false</code>.
If <code>true</code> is set, all the files and directories under the specified <code>URL</code> will be deleted before the transfer starts.
If the parameter is set to <code>false</code> or no value at all, all the existing files and directories under the specified <code>URL</code> will be retained.
New data will either be added or, in the case of existing data, overwritten.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The WebDAV deployment must not be executed in the event of an error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_trigger_sfcc_import_job_schedule"><a class="anchor" href="#_trigger_sfcc_import_job_schedule"></a>Trigger SFCC import job schedule</h4>
<div class="paragraph">
<p>Following the publication of the created XML files via <a href="#wddeployment">WebDAV deployment</a>, the <a href="#sfcc_job_schedules">created job schedule</a> is executed.
In {sf}, the job schedule triggers the import of the generated content and <a href="#slot_configuration">slot configurations</a> into {ccloud}.
The <em>{modulname}</em> module provides the <code>{sf} {ccloud} Importer</code> schedule action for this purpose:</p>
</div>
<div id="sfcc_task" class="imageblock">
<div class="content">
<img src="../../_images/sfcc_task.png" alt="sfcc task">
</div>
<div class="title">Figure 12. Schedule action</div>
</div>
<div class="paragraph">
<p>The action loads a configuration dialog, in which two parameters must be defined in addition to a freely assignable name.</p>
</div>
<div id="sfcc_task_config" class="imageblock">
<div class="content">
<img src="../../_images/import_schedule_task.png" alt="import schedule task">
</div>
<div class="title">Figure 13. Schedule action parameters</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Import Job ID</dt>
<dd>
<p>This field contains the ID of the <a href="#sfcc_job_schedules">created job schedule</a>.</p>
</dd>
<dt class="hdlist1">Timeout</dt>
<dd>
<p>The value in this field displays the time span in seconds, in which the status of the job schedule will be queried every second.
If the job schedule has not completed in the specified time span, this schedule action is indicated as having an error.
The default value is 10 seconds.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As the <code><strong>{sf} {ccloud} Importer</strong></code> requires a successful <a href="#wddeployment">WebDAV deployment</a>, this too must not be executed in the event of an error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="sfcccleanup"><a class="anchor" href="#sfcccleanup"></a>Salesforce Commerce Cloud Cleanup</h4>
<div class="paragraph">
<p>Once the <a href="#sfcc_job_schedules">created job schedule</a> has been executed, content cleanup is executed.
All outdated assets and <a href="#slot_configuration">slot configurations</a> are queried by the <a href="#ocapisettings">OC API</a> and then deleted.
The <em>{modulname}</em> module provides the <code>{sf} {ccloud} Cleanup</code> schedule action for this purpose:</p>
</div>
<div id="sfcc_task" class="imageblock">
<div class="content">
<img src="../../_images/sfcc_cleanup.png" alt="sfcc cleanup">
</div>
<div class="title">Figure 14. Schedule action</div>
</div>
<div class="paragraph">
<p>In addition to a freely assignable name for this schedule action, the associated configuration dialog contains the following parameters:</p>
</div>
<div id="sfcc_task_config" class="imageblock">
<div class="content">
<img src="../../_images/cleanup_schedule_task.png" alt="cleanup schedule task">
</div>
<div class="title">Figure 15. Schedule action parameters</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Use different site</dt>
<dd>
<p>Content cleanup uses a {ccloud} site to find the content assets and slot configurations to be deleted.
The checkbox <code>Use different site</code> allows the use of content cleanup for a site other than the <a href="#project-app-config-base-url">configured</a> site.</p>
</dd>
</dl>
</div>
<div id="cleanupSiteId" class="dlist">
<dl>
<dt class="hdlist1">Site Id</dt>
<dd>
<p>If the <code>Use different site</code> checkbox is active, the {ccloud} site to be used for content cleanup must be specified in this field.</p>
</dd>
<dt class="hdlist1">menu:Content asset cleanup[Enabled]</dt>
<dd>
<p>This checkbox allows to enable/disable the content cleanup of assets.</p>
</dd>
<dt class="hdlist1">Library Id</dt>
<dd>
<p>The ID of the Content Library from that Content Assets are deleted must be entered in this field.
In the case of a private library, the library ID corresponds to the site ID.</p>
</dd>
</dl>
</div>
<div id="additionalRefinements" class="dlist">
<dl>
<dt class="hdlist1">Additional refinement(s)</dt>
<dd>
<p>In this field, attribute names and values can be specified for further filtering of the content assets to be deleted.
The specification must have the following form:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">ATTRIBUTE_NAME=ATTRIBUTE_VALUE [; ATTRIBUTE_NAME=ATTRIBUTE_VALUE] ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The attribute values can contain the following parameters:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Replacement by</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#36;&#123;projectId&#125;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The ID of the generated {fs} project</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&#36;&#123;projectName&#125;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the generated {fs} project</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The specified attributes must exist as custom attributes in the {ccloud} and have been filled with values via the <a href="#generation">{fs} generation</a> before the filtering described here can be used.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">menu:Slot configuration cleanup[Enabled]</dt>
<dd>
<p>This checkbox allows the de-/activation of the content cleanup from <a href="#slot_configuration">Slot configurations</a>.</p>
</dd>
<dt class="hdlist1">Filter query</dt>
<dd>
<p>This field is used to filter the <a href="#slot_configuration">slot configurations</a> to be deleted.
A filter is specified as a <a href="https://documentation.b2c.commercecloud.salesforce.com/DOC2/topic/com.demandware.dochelp/OCAPI/current/data/Documents/Query.html">query document</a> in JSON format.
Within the query, the parameters of the field <a href="#additionalRefinements">Additional refinement(s)</a> can be used, as the following example of a
<a href="https://documentation.b2c.commercecloud.salesforce.com/DOC2/topic/com.demandware.dochelp/OCAPI/current/data/Documents/TextQuery.html">TextQuery</a> illustrates:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">"text_query": {
    "fields": ["c_fsProjectId"],
    "search_phrase": "${{projectIdRaw}}"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>Filter query</code> field remains empty, the <em>{modulname}</em> module uses a <a href="https://documentation.b2c.commercecloud.salesforce.com/DOC2/topic/com.demandware.dochelp/OCAPI/current/data/Documents/MatchAllQuery.html">MatchAllQuery</a>,
whereby the <a href="#slot_configuration">slot configurations</a> to be deleted are not further filtered.</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To avoid inconsistencies in the database or data loss, the action <code><strong>Salesforce {ccloud} Cleanup</strong></code> must be the last action of the schedule.
For the same reason, <a href="#sfcc_content_cleanup">content cleanup</a> requires that this action only performs full generations.
Furthermore, replication within the {ccloud} is not recommended during the execution of the cleanup.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Since the <code><strong>Salesforce {ccloud} Cleanup</strong></code> requires a successful execution of the <a href="#sfcc_job_schedules">job schedules</a> and thus the import of the content, it must not be executed in the event of an error.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_workflows"><a class="anchor" href="#_workflows"></a>Workflows</h3>
<div class="paragraph">
<p>Content is released, deleted, and published by editors within the supplied reference project <em>{projectname}</em> via workflows.
For this reason, it contains a publish workflow, as well as the <em>{bwfs}</em>, which can be used as an alternative to project-specific workflows.</p>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Installing the {bwfs} module</strong></span></p>
</div>
<div class="paragraph">
<p>Before using the workflows, you must install the <em>{bwfs}</em> module on the {fs} server and activate the web component.
The necessary steps are the same as for <a href="#install">installing the other modules</a> and <a href="#wcomp">activating the associated web components</a>.
However, the web component for the <em>{bwfs}</em> is only needed on the <code>{wc}</code> tab page.</p>
</div>
<div class="paragraph">
<p>In addition, to use <em>{bwfs}</em> in the {wc}, the provided <code>{bwfs} Status Provider</code> must be selected in the <code><strong>menu:Project properties[{wc}]</strong></code> area within the <code><strong>{manager}</strong></code>.
In the reference project <em>{projectname}</em>, this setting has already been applied (see figure <a href="#statusprovider">Element Status Provider</a>).</p>
</div>
<div id="statusprovider" class="imageblock">
<div class="content">
<img src="../../_images/statusprovider.png" alt="statusprovider">
</div>
<div class="title">Figure 16. Element Status Provider</div>
</div>
<div class="paragraph">
<p>In addition, in the <code><strong>menu:Project properties[Options]</strong></code> area, the <code>Workflow for deleting elements</code> is preselected.
As a result, any action to delete elements within the project (Del button, delete icon) is executed via this workflow.
The native (independent of a workflow) deletion of elements is therefore not available - not even for the administrator.</p>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Templates</strong></span></p>
</div>
<div class="paragraph">
<p>The <em>{bwfs}</em> and the workflow supplied with the <em> </em> require different templates.
Usually, these need to be imported for the <em>{bwfs}</em> via the context menu in the {fs} project used.
However, they are already available in the reference project and importing the templates is therefore not necessary.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The publish workflow initiates the <a href="#schedule">deployment schedule</a> and requires its name for this.
If this deviates from the <em>Generate and deploy to SFCC</em> expression, the value of the <code>scheduleName</code> variables must be adjusted accordingly within the script <em>SFCC Release Deployment</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Permission assignment</strong></span></p>
</div>
<div class="paragraph">
<p>In the final step, the workflows must be authorized in the individual stores so that they can be executed on {fs} elements.
To do this, select <code><strong>menu:Extras[Change permissions]</strong></code> from the context menu of the stores' root nodes to call up the permission assignment.
This step has also already been carried out in the reference project and is therefore omitted.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The permissions for executing workflows set on the stores' root nodes relate to the <code>Everyone</code> group.
This can only be changed by modifying the permissions manually.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can find more detailed information in the <em>{basicwfsdoc_en}</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="project_settings"><a class="anchor" href="#project_settings"></a>Project settings</h3>
<div class="paragraph">
<p>There is some essential project-specific information that needs to be entered for the connection between {fs} and {ccloud} (see figure <a href="#p_settings">Project settings</a>).
It is entered using the project settings form and must be specified within the reference project.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Changes to the project settings do not take effect straight away, as they are saved in the session of the user.
They require the client to be restarted.</p>
</div>
</td>
</tr>
</table>
</div>
<div id="p_settings" class="imageblock">
<div class="content">
<img src="../../_images/p_settings.png" alt="p settings">
</div>
<div class="title">Figure 17. Project settings</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Storefront Base URL</dt>
<dd>
<p>The field is used to specify the storefront&#8217;s base URL, which is extended with the page type and the ID of the element to be displayed (e.g., product, category, or asset ID).
It has the following format:</p>
<div class="paragraph">
<p><code>https://&lt;SUBDOMAIN INSTANCE&gt;/on/demandware.store/Sites-&lt;SIDE ID&gt;-Site</code></p>
</div>
<div class="paragraph">
<p>More information on the storefront base URL is available in the <em>{ccloud} Documentation</em> in the chapter <a href="https://documentation.demandware.com/DOC2/topic/com.demandware.dochelp/SearchEngineOptimization/DigitalURLSyntaxWithoutSEO.html">menu:Merchandising Your Site[Search Engine Optimization&gt;URL Syntax&gt;Salesforce B2C Commerce URL Syntax Without SEO</a>].</p>
</div>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>As a value of the storefront base URL, only up to the locale, <strong>not</strong> the entire URL must be entered in accordance with its specified format.</p>
</div>
<div class="paragraph">
<p>Example:<br>
<code>https://www.mystore.com/on/demandware.store/​Sites-YourShopHere-Site/</code></p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">SFCC Content Asset ID Prefix</dt>
<dd>
<p>To uniquely identify the content assets generated by {fs}, a prefix for the content asset ID is to be defined at this point.</p>
</dd>
<dt class="hdlist1">Preview Protection (BasicAuth)</dt>
<dd>
<p>Within {ccloud}, it is possible to protect access to the storefront by activating the <code>Online (protected)</code> site status.
If this restriction is applied, the <code>storefront</code> user must be specified in {fs}.
Activating the toggle displays the <code>User</code> and <code>Password</code> fields.</p>
</dd>
<dt class="hdlist1">User</dt>
<dd>
<p>If access restriction is activated in {ccloud}, the <code>storefront</code> user must be specified in this field.</p>
</dd>
<dt class="hdlist1">Password</dt>
<dd>
<p>The password belonging to the <code>storefront</code> user is specified in this field.</p>
</dd>
<dt class="hdlist1">StarterPackage Version</dt>
<dd>
<p>This field is solely utilized to display the version of the used reference project.</p>
</dd>
<dt class="hdlist1">Enable Custom Affixes</dt>
<dd>
<p>The toggle makes it possible to use individual affixes for the HTML comments included in the templates, which are used to indicate the content to be substituted for the preview.
These have the format <code>&lt;!-- CMS-&lt;IDENTIFIER&gt;-START -&#8594;</code> or <code>&lt;!-- CMS-&lt;IDENTIFIER&gt;-END -&#8594;</code> by default.
When the toggle is activated, all four affixes are overwritten and the default values are therefore no longer taken into account.
The specific values can then be specified using the following fields.
If one of the form fields is missing even though the toggle is activated, an empty string is used for the corresponding affix.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For the individual affixes, the format <code>&lt;!-- [OPENING_PREFIX]&lt;IDENTIFIER&gt;[OPENING_SUFFIX] -&#8594;</code> or <code>&lt;!-- [CLOSING_PREFIX]&lt;IDENTIFIER&gt;[CLOSING_SUFFIX] -&#8594;</code> applies.</p>
</div>
<div class="paragraph">
<p>Spaces that are entered in the configuration fields in front of or behind an individual affix are ignored.</p>
</div>
<div class="paragraph">
<p>If the toggle is activated without at least one affix defined, this can lead to unexpected behavior.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Within the reference project, all HTML comments have the standard format.
For this reason, the template for the project settings does not include the toggle or the form fields for the use of individual affixes.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Opening Prefix/Opening Suffix</dt>
<dd>
<p>Together with the identifier, the opening prefix and the opening suffix form the start HTML comment and mark the beginning of the content to be substituted.</p>
</dd>
<dt class="hdlist1">Closing Prefix/Closing Suffix</dt>
<dd>
<p>Together with the identifier, the closing prefix and the closing suffix form the end HTML comment and mark the end of the content to be substituted.</p>
</dd>
<dt class="hdlist1">Storefront-URL Controller Form Field</dt>
<dd>
<p>To determine the storefront URL, the {modulname} {filter} must know which controller (e.g., Home, Page or Search) it needs to address.
This information generally depends on the page to be displayed, which is why the {filter} reads it out from an input component on the preview page form.
The {filter} uses the <code>pt_storefrontUrlController</code> field by default.
This behavior can be configured in the project settings using the <code>ps_storefrontUrlControllerFormField</code> field, in which the name of the form field to be read out is entered if required.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Within the reference project, all page templates have the <code>pt_storefrontUrlController</code> input component as standard.
For this reason, the field for configuring its name is not included in the template for project settings.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Storefront-URL Context ID Form Field</dt>
<dd>
<p>In addition to the controller, the {modulname} {filter} may in some cases require an ID (such as a product, category, or content asset ID); it also determines this on the basis of the page form.
There is the option of configuring the corresponding form field in the project settings using the <code>ps_storefrontUrlContextIdFormField</code> field.
The {filter} reads out the <code>pt_storefrontUrlContextId</code> component by default.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Within the reference project, all page templates have the <code>pt_storefrontUrlContextId</code> input component as standard.
For this reason, the field for configuring its name is not included in the template for project settings.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Additionally, the template is used to initialize two XML collectors and a Product Manager, which are used in the other page and section templates of the project.
These page and section templates define which data is to be transferred to {ccloud}.
During the <a href="#fdeployment">generation process</a>, the data is collected on the basis of these definitions and the XML collectors are filled.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there are project-specific requirements for the XML collectors, then these can be adapted using the methods from the <code>XmlCollectorFactoryExecutable</code> class.
The information required for this is contained in the Javadoc for the class.</p>
</div>
<div class="paragraph">
<p>Information on calling up the Product Manager is contained in the Javadoc for the <code>ManagerFactoryExecutable</code> class.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
