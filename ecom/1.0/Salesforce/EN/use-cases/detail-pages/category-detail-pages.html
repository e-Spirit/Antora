<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: CrownSpirit Documentation</title>
    <link rel="canonical" href="https://e-spirit.github.io/Antora/ecom/1.0/Salesforce/EN/use-cases/detail-pages/category-detail-pages.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../../_'</script>
    <link rel="icon" href="../../../../../../_/img/shortcut-icon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://e-spirit.github.io/Antora">CrownSpirit Documentation</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Cloud</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Headless</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">E-Commerce</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spryker/index.html">Spryker</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spartacus/index.html">Spartacus</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">FirstSpirit</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=editors">Editors</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=developers">Developers</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=administrators">Administrators</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Crownpeak</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ecom" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../../index.html">E-Commerce</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../../Spryker/index.html">Spryker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/spryker-installation/spryker-installation.html">Spryker - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/fs-installation/fs-installation.html">FirstSpirit - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/use-cases/use-cases.html">Use Cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spryker/EN/legal-notice.html">Legal Notice</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spartacus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../../Spartacus/chapters/introduction.html">Main Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/sapcc-installation/sapcc-installation.html">Spartacus - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/fs-installation/fs-installation.html">FirstSpirit - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../../Spartacus/chapters/use-cases/use-cases.html">Use Cases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../Spartacus/FS_Connect_SAP_hl_ServeradminManual_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../index.html">Salesforce</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SAP Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../SAP_Classic/firstspiritconnect-sap-documentation_EN.html">Main Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../../SAP_Classic/firstspiritconnect-sap-admindoc_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">E-Commerce</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../../component-b/1.0/index.html">CrownSpirit Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../component-b/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../../index.html">E-Commerce</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../fsxa-pwa/1.3.0/index.html">FSXA-PWA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../fsxa-pwa/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../fsxa-ui/4.1.0/index.html">FSXA-UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../fsxa-ui/4.1.0/index.html">4.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../../../fsxa-ui/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../../headless/1.0/index.html">Headless</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../../headless/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../../component-b/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/pahl-espirit/ecom/edit/main/modules/Salesforce/pages/EN/use-cases/detail-pages/category-detail-pages.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect3">
<h4 id="catdetailpage"><a class="anchor" href="#catdetailpage"></a>Category detail pages</h4>
<div class="paragraph">
<p>As with the <a href="#catlandingpage">category landing pages</a>, the category detail pages are used to display the products originating from {ccloud}.
However, unlike the category landing pages, they provide an overview of all products belonging to a subcategory.
The products are arranged and the product information displayed automatically and cannot be influenced by the {fs} editor.</p>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Editor view</strong></span><br>
The category detail page only allows an editor to integrate a <a href="#banner_image">static image</a> into the header of the page.
Furthermore, the editor is unable to maintain content.</p>
</div>
<div class="paragraph">
<p><span class="underline"><strong>Developer view</strong></span><br>
Unlike the other pages, which follow the slot-based approach, both <a href="#proddetailpage">product</a> and category detail pages use the <code>Content Integration API (CI API)</code>.
This API enables Velocity fragments that are maintained in the {fs} template to be evaluated on the {sf} side.</p>
</div>
<div class="paragraph">
<p>If the <code>CI API</code> is being used, the hidden <code>Use velocity rendering</code> toggle is activated in the form of the page template within the reference project,
and the <code>Custom</code> parameter is defined in the <code>Preview Page Type</code> form field.
The <code>Content-Render</code> value is also entered in the <code>Velocity rendering controller appendix</code> form field.
This value defines the call of the <code>Content</code> controller that is supplied in the <code>int_espirit_sfra</code> cartridge and carries out Velocity rendering on the {sf} side.
The value must be adapted accordingly if an external controller is being used.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The chapter about the <a href="#login_page">login page</a> describes in more detail how an individual page type can be defined.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another difference compared to the other pages is that the category detail pages only generate a single asset, just like the <a href="#contentpage">content pages</a>.
This asset is created in the HTML channel of the page template, which differentiates between the display of the page in the <a href="#uc_preview">{fs} preview</a> and in the live state.
The developer view must therefore take both the preview as well as the generation and the live state into account.</p>
</div>
<div class="paragraph">
<p><strong>Preview</strong></p>
</div>
<div class="paragraph">
<p>The Velocity fragments can be used to insert {sf} widgets provided by the <code>Common</code> controller in a page.
The <code>$include.widget()</code> function, which is defined in the <code>Content</code> controller, deals with the integration process.
The required widget must be transferred to this function as a parameter.</p>
</div>
<div class="paragraph">
<p>The code example below shows the integration of the {sf} Page Header in the category detail page:</p>
</div>
<div class="listingblock">
<div class="title">Page Header integration</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-FirstSpirit hljs" data-lang="FirstSpirit">&lt;!-- CMS-VELOCITY-PAGE_HEADER-START --&gt;
   $include.widget('Common-PageHeader')
&lt;!-- CMS-VELOCITY-PAGE_HEADER-END --&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In addition to the general widgets, the <code>CategorySearchResult</code> controller integrates specific data into the category detail page:
In the case of the preview, for example, it uses the category ID of the selected subcategory to determine the corresponding products, and then displays these in the <a href="#uc_preview">preview</a>.
This data is already provided in the live state and is available to use via the <code>$categorySearchResult</code> variable.</p>
</div>
<div class="listingblock">
<div class="title">Integrating subcategory products</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-FirstSpirit hljs" data-lang="FirstSpirit">&lt;!-- CMS-VELOCITY-SEARCH_RESULT-START --&gt;
   $CMS_IF(#global.preview)$
      $include.widget('CategorySearchResult-Show', 'cgid', '$CMS_VALUE(pt_storefrontUrlContextId)$')
   $CMS_ELSE$
      $categorySearchResult
   $CMS_END_IF$
   [...]
&lt;!-- CMS-VELOCITY-SEARCH_RESULT-END --&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Generation</strong></p>
</div>
<div class="paragraph">
<p>For generation purposes, it is important to ensure firstly that the corresponding page is marked as translated in {fs} and that the <code>SFCC Context ID</code> field is populated.
The <code>SFCC Context ID</code> corresponds to the category ID from the storefront.
When a category detail page is being generated via the report, the ID is automatically saved to the associated form field.
The generation is only carried out and the asset for the category detail page is only created once the form field is populated and the corresponding page is marked as translated in {fs}.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-FirstSpirit hljs" data-lang="FirstSpirit">$CMS_IF(!#global.preview &amp;&amp; !#global.page.isTranslated || pt_storefrontUrlContextId.isEmpty)$
   $CMS_SET(#global.stopGenerate, true)$
$CMS_END_IF$</code></pre>
</div>
</div>
<div class="paragraph">
<p>The editorial content is then saved in the <code>set_pageContent</code> variable, and the <code>set_parent_id</code> variable is assigned the value of the hidden <code>SFCC Parent Folder</code> field.
This value specifies where the created asset is filed in the {sf} folder structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-FirstSpirit hljs" data-lang="FirstSpirit">$CMS_SET(set_parent_id,pt_dwre_parentFolder)$</code></pre>
</div>
</div>
<div class="paragraph">
<p>Both variables are evaluated while the XML collector is populated, a process that is carried out subsequently.
In the process, a new content node is created, to which the editorial content of the page, among other things, is added.</p>
</div>
<div class="paragraph">
<p><strong>Live state</strong></p>
</div>
<div class="paragraph">
<p>A category detail page already exists for subcategories on the {sf} side as standard.
This page is used for the live state.
The display is controlled by the <a href="#cartridges">Search controller</a>, which has been expanded to take account of assets generated on the {fs} side.
Using this expansion and a category ID assigned to it, the controller first checks whether a category detail page that has been generated with {fs} is present.
If one is present, it is rendered in the live state with the Velocity engine.
Otherwise, the {sf} standard page is displayed.</p>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../../../../../_/js/site.js"></script>
<script async src="../../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
