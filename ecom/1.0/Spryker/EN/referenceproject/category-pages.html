<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: CrownSpirit Documentation</title>
    <link rel="canonical" href="https://e-spirit.github.io/Antora/ecom/1.0/Spryker/EN/referenceproject/category-pages.html">
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../../_'</script>
    <link rel="icon" href="../../../../../_/img/shortcut-icon.ico" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://e-spirit.github.io/Antora">CrownSpirit Documentation</a>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://e-spirit.github.io/Antora/cloud/1.0/index.html">Cloud</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Headless</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/headless/1.0/CaaS/CaaS_FSM_Documentation_EN.html">CaaS</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/headless/1.0/CaaS_Connect/CaaS_Connect_FSM_Documentation_EN.html">CaaS Connect</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/headless/1.0/CaaS_Platform/CaaS_Platform_Documentation_EN.html">CaaS Platform</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/headless/1.0/Nav_Service_FSM/index.html">Navigation Service (FSM)</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/headless/1.0/Nav_Service_Platform/documentation.html">Navigation Service (Platform)</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">E-Commerce</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spryker/index.html">Spryker</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Spartacus/chapters/introduction.html">Spartacus</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/Salesforce/index.html">Salesforce</a>
            <a class="navbar-item" href="https://e-spirit.github.io/Antora/ecom/1.0/SAP_Classic/firstspiritconnect-sap-documentation_EN.html">SAP Classic</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">FirstSpirit</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=editors">Editors</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=developers">Developers</a>
            <a class="navbar-item" href="https://docs.e-spirit.com/lp/?locale=en&main=firstspirit&sub=administrators">Administrators</a>
          </div>
        </div>
        <a class="navbar-item" href="https://e-spirit.github.io/Antora/dxm/1.0/index.html">DXM</a>
        <a class="navbar-item" href="https://community.crownpeak.com/t5/DQM/ct-p/dqm">DQM</a>
        <a class="navbar-item" href="https://community.crownpeak.com/t5/DG/ct-p/dg">DG</a>
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="ecom" data-version="1.0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../../index.html">E-Commerce</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../index.html">Spryker</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../spryker-installation/spryker-installation.html">Spryker - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../fs-installation/fs-installation.html">FirstSpirit - Installation and Configuration</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../use-cases/use-cases.html">Use Cases</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../legal-notice.html">Legal Notice</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Spartacus</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../../Spartacus/chapters/introduction.html">Main Documentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/sapcc-installation/sapcc-installation.html">Spartacus - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/fs-installation/fs-installation.html">FirstSpirit - Installation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/referenceproject/referenceproject.html">Reference Project</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../../Spartacus/chapters/use-cases/use-cases.html">Use Cases</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../Spartacus/FS_Connect_SAP_hl_ServeradminManual_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../../Salesforce/index.html">Salesforce</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">SAP Classic</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../SAP_Classic/firstspiritconnect-sap-documentation_EN.html">Main Documentation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../../SAP_Classic/firstspiritconnect-sap-admindoc_EN.html">Admin Manual</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">E-Commerce</span>
    <span class="version">1.0</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../../../component-b/1.0/index.html">CrownSpirit Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../component-b/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../dxm/1.0/index.html">DXM</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../dxm/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../../../index.html">E-Commerce</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../../index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../cloud/1.0/index.html">FirstSpirit Cloud</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../cloud/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../fsxa-pwa/1.3.0/index.html">FSXA-PWA</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../fsxa-pwa/1.3.0/index.html">1.3.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../fsxa-ui/4.1.0/index.html">FSXA-UI</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../fsxa-ui/4.1.0/index.html">4.1.0</a>
        </li>
        <li class="version">
          <a href="../../../../../fsxa-ui/3.0.0/index.html">3.0.0</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../../headless/1.0/index.html">Headless</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../../headless/1.0/index.html">1.0</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../../component-b/1.0/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/pahl-espirit/ecom/edit/main/modules/Spryker/pages/EN/referenceproject/category-pages.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<div class="sect1">
<h2 id="rp_categorypages"><a class="anchor" href="#rp_categorypages"></a>Extension of existing category pages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Just like the <a href="#rp_staticsite">static pages</a> described above, category pages that already exist on the   side can also be displayed in {cc} using the <em>{ocm}</em> and enriched with editorial content.
This also requires the filling of the output channel of the page and section template within the {fs} project as well as a adaptation of the corresponding Twig templates in  .</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If there are references to categories or products within the {fs} project which have been deleted or are inactive in  , so-called orphaned pages occur.
These can be removed from the project via the <a href="#uc_orphanedpages">report <code><strong>Lost and Found</strong></code></a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="rp_cp_pagetemp"><a class="anchor" href="#rp_cp_pagetemp"></a>Page template</h3>
<div class="paragraph">
<p>Just like <a href="#rp_pagetemp">static pages</a>, the extension of a category page in the {fs} project is based on a page reference.
It and its associated page are also automatically created in the background and invisible to the editor.</p>
</div>
<div class="paragraph">
<p>The reference project contains the page template <code>categorypage</code>, which is an example of a category page and maps the Twig template <code>catalog-with-cms-slot.twig</code>.
The following code fragment shows the {categorypage_caas_channel}[output channel] of this page template:</p>
</div>
<div class="listingblock">
<div class="title">Output channel of the page template categorypage</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-XML hljs" data-lang="XML">$CMS_TRIM(level:1)$
   $CMS_SET(json, {:})$
   $CMS_SET(previewId, previewId(element:#global.node))$
   $CMS_SET(void, json.put("previewId", "" + previewId))$
   $CMS_SET(void, json.put("pageRevisionId", #global.page.revision.id))$
   $CMS_SET(void, json.put("pagetype", "category"))$
   $CMS_SET(blocks, [])$

   $CMS_VALUE(#global.page.body("banner"))$
   $CMS_VALUE(#global.page.body("top"))$
   $CMS_VALUE(#global.page.body("bottom"))$
   $CMS_SET(void, json.put("blocks", blocks))$

   $CMS_VALUE(json.toJSON)$
$CMS_END_TRIM$</code></pre>
</div>
</div>
<div class="paragraph">
<p>The {categorypage_caas_channel}[output channel] of the category page is almost identical to that of the {homepage_caas_channel}[homepage], which corresponds to a <a href="#rp_pagetemp">static page</a>.
It differs only in the page type, the revision id and in the number of content areas.
The page type is used to determine the block name and must have the value <code>category</code> at this point.
The block name is determined depending on the page type using the {format_block_render}[render template <code>block_name_render</code>], which is referenced in the output channel of the respective <a href="#rp_section">section</a>.
The content areas of the page template correspond to the CMS block positions defined on the   side.
They must therefore be named identically.</p>
</div>
</div>
<div class="sect2">
<h3 id="rp_cp_sectiontemp"><a class="anchor" href="#rp_cp_sectiontemp"></a>Section template</h3>
<div class="paragraph">
<p>In addition to the already described <a href="#rp_section">Shoppable Video section</a> and the Text-Image section, the {carousel_github}[section template <code>carousel_section</code>] is available for adding editorial content to category pages.
The carousel section in turn embeds one or more {banner_github}[banners].</p>
</div>
<div class="paragraph">
<p>The banner allows the selection of an image that can be cut to size as well as the definition of a link, a title and a subtitle.
For both the heading and the subtitle, a text color can be selected.
Unlike the other sections, which can be used only on subcategory pages, the banner can be embedded on all category pages.</p>
</div>
<div class="paragraph">
<p>The banner corresponds to the   molecule <code>fs-banner.twig</code>, whose output is also controlled by the generic Twig template <code>fs_molecule_block.twig</code>.
This corresponds to a generic template that regulates the output of all molecules.</p>
</div>
<div class="paragraph">
<p>The {banner_caas_channel}[output channel] of the banner is almost identical to that of the {video_caas_channel}[Shoppable Video section] and only differs in the evaluation of the available input components.
For this reason, no additional extensions are required that go beyond the requirements already described for the Shoppable Video section.</p>
</div>
</div>
<div class="sect2">
<h3 id="rp_cp_twigtemp"><a class="anchor" href="#rp_cp_twigtemp"></a>Twig Templates</h3>
<div class="paragraph">
<p>The {categorypage_caas_channel}[{fs} page template <code>categorypage</code>] contained in the reference project is an example of a category page.
It has the content areas <code>banner</code>, <code>top</code> and <code>bottom</code> and maps the Twig template <code>catalog-with-cms-slot.twig</code>.
This is stored in   under the path <code><strong>src/Pyz/Yves/CatalogPage/Theme/default/views/catalog-with-cms-slot</strong></code>
and extends the parent template <code>page-layout-catalog.twig</code>, which defines the base layout of all category pages.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To make category pages editable in {cc}, the CMS blocks within both templates must be integrated using the Twig function <code>fsSpyCmsBlock</code>.</p>
</div>
<div class="paragraph">
<p>Unlike the CMS block <code>banner</code>, which is available on all category pages, the CMS blocks <code>top</code> and <code>bottom</code> can only be used on subcategory pages.
If they should also be available on all category pages, the template <code>Catalog + CMS Slot</code> must be selected for them in  .</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following code example shows the Twig template <code>catalog-with-cms-slot.twig</code> including the adjustments necessary for editing in {fs}.
Since only for the positions <code>top</code> and <code>bottom</code> content areas exist in the {fs} page template, the integration of the CMS blocks takes place exclusively in these two cases via the Twig function <code>fsSpyCmsBlock</code>.</p>
</div>
<div class="listingblock">
<div class="title">Adaptation of the Twig template catalog-with-cms-slot.twig</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-PHP hljs" data-lang="PHP">{% extends template('page-layout-catalog', 'CatalogPage') %}

[...]

{% block catalogContent %}
   {% if data.categoryId %}
      &lt;div class="catalog-cms-block catalog-cms-block--top"&gt;
         {{ fsSpyCmsBlock({category: data.categoryId, position: 'top'}) }}
         {% cms_slot 'slt-4' required ['idCategory'] with {
            idCategory: data.categoryId,
         } %}
      &lt;/div&gt;
   {% endif %}

   {{ parent() }}

   {% if data.categoryId %}
      &lt;div class="catalog-cms-block catalog-cms-block--bottom"&gt;
         {{ fsSpyCmsBlock({category: data.categoryId, position: 'bottom'}) }}
         {% cms_slot 'slt-6' required ['idCategory'] with {
            idCategory: data.categoryId,
         } %}
      &lt;/div&gt;
   {% endif %}
{% endblock %}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each CMS block corresponds to a {fs} section placed at a specific position on the category page.
The use of positions in category pages is enabled   sided by the <code>CMS Block Category Connector</code> feature, which is already configured within the demo shop.
The feature provides by default the positions <code>top</code>, <code>middle</code> and <code>bottom</code>.
In {fs}, the positions are represented by the content areas of the corresponding page template.
For this reason, the names of the content areas and the names of the positions defined for category pages must be identical.</p>
</div>
<div class="paragraph">
<p>For the integration of the <a href="#rp_cp_sectiontemp">banner</a> the feature must be additionally extended by the position <code>banner</code>.
For this the file <code>cms_block_category_position.csv</code> within the directory <code><strong>data/import</strong></code> has to be adapted accordingly.
The transfer of the new position is then done via the following command, which has to be executed in the   project directory.</p>
</div>
<div class="listingblock">
<div class="title">Update command</div>
<div class="content">
<pre>console data:import:cms-block-category-position</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>A more detailed description of the configuration of positions for category pages can be found in the chapter
<a href="https://documentation.spryker.com/docs/enabling-category-cms-block#usage-for-demoshop">Usage for Demoshop</a> of the <em>  documentation</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Furthermore, the CMS block <code>banner</code> has to be added to the superior Twig template <code>page-layout-catalog.twig</code>, which is stored in the directory <code><strong>src/Pyz/Yves/CatalogPage/Theme/default/templates/page-layout-catalog</strong></code>.
Therefore, the existing <code>block title</code> section within the template must be replaced by the following code.</p>
</div>
<div class="listingblock">
<div class="title">Integration of the banner</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-PHP hljs" data-lang="PHP">{% block title %}
   {{ fsSpyCmsBlock({category:data.category.id_category, position: 'banner'}) }}
{% endblock %}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In  , the banner corresponds to the molecule <code>fs-banner</code>.
The following code fragment shows the content of the molecule in a highly abbreviated form:</p>
</div>
<div class="listingblock">
<div class="title">Molecule fs-banner</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-PHP hljs" data-lang="PHP">{% extends model('component') %}

{% define config = {
   name: 'fs-banner',
   tag: 'fs-banner'
} %}

{% define data = {
   fsBlockData: []
} %}

{% block body %}
   {% set url -%}
      {%- if data.fsBlockData.link is defined and data.fsBlockData.link is not empty -%}
         {%- include template('link', 'FirstSpiritPreview') with { link: data.fsBlockData.link } -%}
      {%- endif -%}
   {%- endset %}
   &lt;figure class="fs-banner"
      {% if data.fsBlockData.variantEditorName is defined %}
         data-variant-editor-name="{{ data.fsBlockData.variantEditorName }}"
      {% endif %}
      {% if data.fsBlockData.variant is defined and data.fsBlockData.variant is not empty %}
         data-variant="{{data.fsBlockData.variant}}"
      {% endif %}
      {% if data.fsBlockData.previewId is defined and data.fsBlockData.previewId is not empty %}
         data-preview-id="{{data.fsBlockData.previewId}}"
      {% endif %}&gt;

      [...]

      &lt;img src="{{ data.fsBlockData.picture.imageUrl }}"
         {% if data.fsBlockData.picture.previewId is defined %}
            data-preview-id="{{ data.fsBlockData.picture.previewId }}"
            data-tpp-context-image-resolution="BANNER_IMAGE"
         {% endif %}&gt;

      [...]

   &lt;/figure&gt;
{% endblock %}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Within the template, the name and the tag of the molecule are defined first and then the fsBlockData object is created.
It provides access to the structured data defined in the output channel of the <a href="#rp_cp_sectiontemp">{fs} section template</a>.
In the preview case, this data is obtained directly from the <em>Preview {c}</em>.
In contrast, the data for the live state comes from  .
For this they are imported during the <a href="#fs-deployment">{fs} generation</a> from the <em>Online {c}</em> and persisted in  .
The fsBlockData object and the JSON object created in {fs} thus have the same structure.</p>
</div>
<div class="paragraph">
<p>The block <code>body</code> describes the output of the editorial content.
These correspond to a cropable image and a link as well as a title and a subtitle, for each of which a text color is defined.</p>
</div>
<div class="paragraph">
<p>The following figure shows the representation of a carousel with an embedded banner in the {cc}.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../../_images/banner.png" alt="banner">
</div>
<div class="title">Figure 1. Carousel with a single element</div>
</div>
<div id="fs_molecule" class="paragraph">
<p>The output of all molecules is controlled by the generic Twig template <code>fs_molecule_block.twig</code>.
The following code fragment shows the content of this template:</p>
</div>
<div class="listingblock">
<div class="title">Generic Twig template for the output of all molecules</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-PHP hljs" data-lang="PHP">{% define data = {
   fsBlockData: fsBlockData()
} %}

{% block content %}
   {% include molecule( data.fsBlockData.moleculename, 'FirstSpiritReferenceComponents') with{
      data: {
         fsBlockData: data.fsBlockData
      }
      attributes: {
         'data-attributes': data.fsBlockData.attributes | default('') | json_encode
      }
   }only %}
{% endblock %}</code></pre>
</div>
</div>
<div class="paragraph">
<p>As in the Twig template of the molecule, the fsBlockData object is first created in the generic template.
The block <code>content</code> then includes the molecule specified in the <a href="#rp_section">{fs} section template</a> for the parameter <code>moleculename</code>.
In  , the molecule is stored in the <a href="#sp_twigtemplates">directory <code><strong>{fs}ReferenceComponents</strong></code></a>.
In this way, the Twig template generically controls the output of all molecules and creates the mapping between the {fs} section template and the respective   block Twig template.</p>
</div>
<div class="paragraph">
<p>The <code>attributes</code> attribute provides additional configuration attributes that can be defined in the output channel of a section template.
They are provided in this way directly in the tag of the corresponding molecule, so that they can be easily accessed via TypeScript.
If no configuration attributes are defined within the output channel of a section, the <code>attributes</code> attribute remains empty.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script src="../../../../../_/js/site.js"></script>
<script async src="../../../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
